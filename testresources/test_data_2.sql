drop table if exists file_raw_2;
create table file_raw_2 (
id int,
date_id date,
hour_id int null, 
min_id int null, 
gummei varchar(14) null, 
causecode int null, 
subcausecode int null,
bearer_cause int null);

insert into file_raw_2 (id, date_id, hour_id, min_id, gummei, causecode, subcausecode, bearer_cause) values 
(13, '2015-04-16', 20, 19, '0013f410000401', 0, 641, 3),
(13, '2015-04-16', 20, 20, '0013f410000401', 0, 10, 959),
(13, '2015-04-16', 20, 20, '0013f410000401', 0, 775, null),
(13, '2015-04-16', 20, 21, '0013f410000401', 0, 643, 2),
(13, '2015-04-16', 20, 22, '0013f410000401', 0, 643, 1),
(13, '2015-04-16', 20, 23, '0013f410000401', 2, 14, null),
(13, '2015-04-16', 20, 23, '0013f410000401', 0, 641, 2),
(13, '2015-04-16', 20, 25, '0013f410000401', 0, 641, 3),
(13, '2015-04-16', 20, 25, '0013f410000401', 0, 10, 512),
(13, '2015-04-16', 20, 27, '0013f410000401', 0, 454, 2),
(13, '2015-04-16', 20, 27, '0013f410000401', 0, 641, null),
(13, '2015-04-16', 20, 29, '0013f410000401', 0, 2, 955),
(13, '2015-04-16', 20, 30, '0013f410000401', 2, 17, 4);



drop table if exists eniq_test_raw_2;
create table eniq_test_raw_2 (
event_id int,
date_id date, 
hour_id int null, 
min_id int null, 
mcc varchar(3) null, 
mnc varchar(3), 
cause_code int null, 
subcause_code int null, 
bearer_cause_1 int null);


insert into eniq_test_raw_2 (event_id, date_id, hour_id, min_id, mcc, mnc, cause_code, subcause_code, bearer_cause_1) values 
(12, '2015-04-16', 20, 19, '310', '410', 0, 641, 3),
(12, '2015-04-16', 20, 20, '310', '410', 0, 10, 959),
(12, '2015-04-16', 20, 20, '310', '410', 0, 775, 0),
(12, '2015-04-16', 20, 21, '310', '410', 0, 643, 2),
(12, '2015-04-16', 20, 22, '310', '410', 0, 643, 1),
(12, '2015-04-16', 20, 23, '310', '410', 2, 14, 0),
(12, '2015-04-16', 20, 23, '310', '410', 0, 641, 2),
(12, '2015-04-16', 20, 25, '310', '410', 0, 641, 3),
(12, '2015-04-16', 20, 25, '310', '410', 0, 10, 512),
(12, '2015-04-16', 20, 27, '310', '410', 0, 454, 2),
(12, '2015-04-16', 20, 27, '310', '410', 0, 641, 0),
(12, '2015-04-16', 20, 29, '310', '410', 0, 2, 955),
(12, '2015-04-16', 20, 30, '310', '410', 2, 17, 4),

(13, '2015-04-16', 20, 19, '310', '410', 0, 641, 3),
(13, '2015-04-16', 20, 20, '310', '410', 0, 10, 959),
(13, '2015-04-16', 20, 20, '310', '410', 0, 775, 0),
(13, '2015-04-16', 20, 21, '310', '410', 0, 643, 2),
(13, '2015-04-16', 20, 22, '310', '410', 0, 643, 1),
(13, '2015-04-16', 20, 23, '310', '410', 2, 14, 0),
(13, '2015-04-16', 20, 23, '310', '410', 0, 641, 2),
(13, '2015-04-16', 20, 25, '310', '410', 0, 641, 3),
(13, '2015-04-16', 20, 25, '310', '410', 0, 10, 512),
(13, '2015-04-16', 20, 27, '310', '410', 0, 454, 2),
(13, '2015-04-16', 20, 27, '310', '410', 0, 641, 0),
(13, '2015-04-16', 20, 29, '310', '410', 0, 2, 955),
(13, '2015-04-16', 20, 30, '310', '410', 2, 17, 4),

(10, '2015-04-16', 20, 19, '310', '410', 0, 641, 3),
(10, '2015-04-16', 20, 20, '310', '410', 0, 10, 959),
(10, '2015-04-16', 20, 20, '310', '410', 0, 775, 0),
(10, '2015-04-16', 20, 21, '310', '410', 0, 643, 2),
(10, '2015-04-16', 20, 22, '310', '410', 0, 643, 1),
(10, '2015-04-16', 20, 23, '310', '410', 2, 14, 0),
(10, '2015-04-16', 20, 23, '310', '410', 0, 641, 2),
(10, '2015-04-16', 20, 25, '310', '410', 0, 641, 3),
(10, '2015-04-16', 20, 25, '310', '410', 0, 10, 512),
(10, '2015-04-16', 20, 27, '310', '410', 0, 454, 2),
(10, '2015-04-16', 20, 27, '310', '410', 0, 641, 0),
(10, '2015-04-16', 20, 29, '310', '410', 0, 2, 955),
(10, '2015-04-16', 20, 30, '310', '410', 2, 17, 4);





drop table if exists eniq_test_15min_2;
create table eniq_test_15min_2 (
event_id int,
date_id date, 
hour_id int null, 
min_id int null, 
mcc varchar(3) null, 
mnc varchar(3), 
cause_code int null, 
subcause_code int null, 
no_of_errors int,
total_bearer_1 int,
avg_bearer_1 numeric(16, 2),
max_bearer_1 int,
min_bearer_1 int);



insert into eniq_test_15min_2 (event_id, date_id, hour_id, min_id, mcc, mnc, cause_code, subcause_code, no_of_errors, total_bearer_1, avg_bearer_1, max_bearer_1, min_bearer_1) values (10, '2015-04-16', 20, 0, '310', '410', 0, 642, 1, 2, 2, 2, 2),
 (10, '2015-04-16', 20, 0, '310', '410', 0, 643, 1, 3, 3, 3, 3),
 (10, '2015-04-16', 20, 0, '310', '410', 2, 13, 1, 204, 204, 204, 204),
 (12, '2015-04-16', 20, 0, '310', '410', 0, 457, 1, 0, 0.00, 0, 0),
 (12, '2015-04-16', 20, 0, '310', '410', 0, 458, 1, 691, 691, 691, 691),
 (12, '2015-04-16', 20, 0, '310', '410', 0, 640, 1, 1, 1.00, 1, 1),
 (12, '2015-04-16', 20, 0, '310', '410', 0, 641, 3, 5, 1.67, 2, 1),
 (12, '2015-04-16', 20, 0, '310', '410', 0, 643, 2, 4, 2.00, 3, 1),
 (12, '2015-04-16', 20, 0, '310', '410', 2, 462, 1, 2, 2, 2, 2),
 (12, '2015-04-16', 20, 0, '310', '410', 2, 463, 1, 3, 3.00, 3, 3),
 (12, '2015-04-16', 20, 0, '310', '410', 2, 464, 1, 3, 3, 3, 3),
 (13, '2015-04-16', 20, 0, '310', '410', 0, 457, 1, 697, 697, 697, 697),
 (13, '2015-04-16', 20, 0, '310', '410', 0, 640, 3, 5, 1.66, 3, 0),
 (13, '2015-04-16', 20, 0, '310', '410', 0, 642, 1, 0, 0.00, 0, 0),
 (13, '2015-04-16', 20, 0, '310', '410', 0, 643, 1, 0, 0.00, 0, 0),
 (13, '2015-04-16', 20, 0, '310', '410', 2, 13, 1, 1, 1, 1, 1),
 (13, '2015-04-16', 20, 0, '310', '410', 2, 460, 1, 660, 660, 660, 660),
 (13, '2015-04-16', 20, 0, '310', '410', 2, 461, 2, 385, 192.5, 382, 3),

 (10, '2015-04-16', 20, 15, '310', '410', 0, 2, 1, 955, 955, 955, 955),
 (10, '2015-04-16', 20, 15, '310', '410', 0, 10, 2, 1471, 735.5, 959, 512),
 (10, '2015-04-16', 20, 15, '310', '410', 0, 454, 1, 2, 2, 2, 2),
 (10, '2015-04-16', 20, 15, '310', '410', 0, 641, 4, 8, 2, 3, 0),
 (10, '2015-04-16', 20, 15, '310', '410', 0, 643, 2, 3, 1.5, 2, 1),
 (10, '2015-04-16', 20, 15, '310', '410', 0, 775, 1, 0, 0.00, 0, 0),
 (10, '2015-04-16', 20, 15, '310', '410', 2, 14, 1, 0, 0.00, 0, 0),
 (10, '2015-04-16', 20, 15, '310', '410', 2, 17, 1, 4, 4.00, 4, 4),
 (12, '2015-04-16', 20, 15, '310', '410', 0, 2, 1, 955, 955, 955, 955),
 (12, '2015-04-16', 20, 15, '310', '410', 0, 10, 2, 1471, 0.0, 959, 512),
 (12, '2015-04-16', 20, 15, '310', '410', 0, 454, 1, 2, 2, 2, 2),
 (12, '2015-04-16', 20, 15, '310', '410', 0, 641, 4, 8, 2, 3, 0),
 (12, '2015-04-16', 20, 15, '310', '410', 0, 643, 2, 3, 1.5, 2, 1),
 (12, '2015-04-16', 20, 15, '310', '410', 0, 775, 1, 0, 0.00, 0, 0),
 (12, '2015-04-16', 20, 15, '310', '410', 2, 14, 1, 0, 0.00, 0, 0),
 (12, '2015-04-16', 20, 15, '310', '410', 2, 17, 1, 4, 4, 4, 4),
 (13, '2015-04-16', 20, 15, '310', '410', 0, 2, 1, 955, 955, 955, 955),
 (13, '2015-04-16', 20, 15, '310', '410', 0, 10, 2, 1471, 735.5, 959, 512),
 (13, '2015-04-16', 20, 15, '310', '410', 0, 454, 1, 2, 2, 2, 2),
 (13, '2015-04-16', 20, 15, '310', '410', 0, 641, 4, 8, 2, 3, 0),
 (13, '2015-04-16', 20, 15, '310', '410', 0, 643, 2, 3, 1.50, 2, 1),
 (13, '2015-04-16', 20, 15, '310', '410', 0, 775, 1, 0, 0.00, 0, 0),
 (13, '2015-04-16', 20, 15, '310', '410', 2, 14, 1, 0, 0.00E+00, 0, 0),
 (13, '2015-04-16', 20, 15, '310', '410', 2, 17, 1, 4, 4, 4, 4),

 (10, '2015-04-16', 20, 30, '310', '410', 0, 640, 1, 2, 2, 2, 2),
 (10, '2015-04-16', 20, 30, '310', '410', 0, 641, 1, 2, 2, 2, 2),
 (12, '2015-04-16', 20, 30, '310', '410', 0, 642, 1, 1, 1, 1, 1),
 (12, '2015-04-16', 20, 30, '310', '410', 2, 462, 1, 883, 8.83, 883, 883),
 (13, '2015-04-16', 20, 30, '310', '410', 0, 0, 1, 171, 171, 171, 171),
 (13, '2015-04-16', 20, 30, '310', '410', 0, 2, 1, 2, 2.00, 2, 2),
 (13, '2015-04-16', 20, 30, '310', '410', 0, 641, 4, 6, 1.50, 3, 0),
 (13, '2015-04-16', 20, 30, '310', '410', 0, 642, 1, 2, 2.00, 2, 2),
 (13, '2015-04-16', 20, 30, '310', '410', 0, 643, 2, 4, 2, 2, 2);

 commit;